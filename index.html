<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title>PT.BRONZE-402 Console</title>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg: #020617;
        --bg-accent: radial-gradient(circle at top, #1d4ed8 0, transparent 55%),
          radial-gradient(circle at bottom, #22c55e 0, transparent 55%);
        --card: rgba(10, 16, 32, 0.96);
        --card-border: rgba(148, 163, 184, 0.45);
        --text: #e5e7eb;
        --muted: #9ca3af;
        --accent: #22c55e;
        --accent-soft: rgba(34, 197, 94, 0.2);
        --danger: #f97373;
        --glass: rgba(15, 23, 42, 0.9);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--bg);
        background-image: var(--bg-accent);
        color: var(--text);
        padding: 1.5rem;
        font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont,
          'Segoe UI', sans-serif;
        perspective: 1200px;
        overflow: hidden;
      }

      .shell {
        width: 100%;
        max-width: 760px;
        border-radius: 1.8rem;
        background:
          radial-gradient(circle at -20% -20%, rgba(59, 130, 246, 0.2), transparent 55%),
          radial-gradient(circle at 120% 120%, rgba(34, 197, 94, 0.2), transparent 55%),
          var(--card);
        border: 1px solid var(--card-border);
        box-shadow:
          0 26px 80px rgba(15, 23, 42, 0.95),
          inset 0 0 0 1px rgba(15, 23, 42, 0.9);
        padding: 1.8rem 1.9rem 1.5rem;
        position: relative;
        overflow: hidden;
        transform-style: preserve-3d;
        transform: rotateX(10deg);
        transition: transform 0.25s ease-out, box-shadow 0.25s ease-out;
      }

      .shell:hover {
        transform: rotateX(6deg) translateY(-4px);
        box-shadow:
          0 40px 100px rgba(15, 23, 42, 1),
          inset 0 0 0 1px rgba(15, 23, 42, 0.9);
      }

      .shell::before {
        content: '';
        position: absolute;
        inset: -40%;
        background:
          radial-gradient(circle at 0 0, rgba(56, 189, 248, 0.22), transparent 55%),
          radial-gradient(circle at 100% 100%, rgba(244, 63, 94, 0.18), transparent 55%);
        opacity: 0.6;
        pointer-events: none;
        mix-blend-mode: screen;
      }

      .content {
        position: relative;
        z-index: 1;
        transform-style: preserve-3d;
      }

      .header-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1.3rem;
      }

      .title-block {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
      }

      h1 {
        font-family: 'Orbitron', system-ui, sans-serif;
        font-size: 1.4rem;
        margin: 0;
        letter-spacing: 0.26em;
        text-transform: uppercase;
        background: linear-gradient(120deg, #22d3ee, #a855f7, #22c55e);
        background-size: 240% 240%;
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        text-shadow:
          0 0 6px rgba(34, 211, 238, 0.8),
          0 0 16px rgba(168, 85, 247, 0.75);
        animation: neonShift 9s ease-in-out infinite alternate;
      }

      @keyframes neonShift {
        0% {
          background-position: 0% 50%;
          text-shadow:
            0 0 4px rgba(34, 211, 238, 0.7),
            0 0 12px rgba(56, 189, 248, 0.8);
        }
        50% {
          background-position: 50% 100%;
          text-shadow:
            0 0 6px rgba(168, 85, 247, 0.8),
            0 0 18px rgba(147, 51, 234, 0.9);
        }
        100% {
          background-position: 100% 50%;
          text-shadow:
            0 0 6px rgba(34, 197, 94, 0.9),
            0 0 20px rgba(34, 197, 94, 0.9);
        }
      }

      .subtitle {
        font-family: 'Orbitron', system-ui, sans-serif;
        font-size: 0.72rem;
        letter-spacing: 0.22em;
        text-transform: uppercase;
        margin-top: 0.1rem;
        background: linear-gradient(120deg, #f97316, #facc15, #22c55e);
        background-size: 200% 200%;
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        text-shadow:
          0 0 4px rgba(234, 179, 8, 0.9),
          0 0 10px rgba(245, 158, 11, 0.9);
        animation: subtitleGlow 6s ease-in-out infinite alternate;
      }

      @keyframes subtitleGlow {
        0% {
          background-position: 0% 50%;
          text-shadow:
            0 0 3px rgba(234, 179, 8, 0.7),
            0 0 7px rgba(245, 158, 11, 0.7);
        }
        50% {
          background-position: 100% 50%;
          text-shadow:
            0 0 4px rgba(249, 115, 22, 0.9),
            0 0 13px rgba(234, 179, 8, 1);
        }
        100% {
          background-position: 50% 100%;
          text-shadow:
            0 0 4px rgba(34, 197, 94, 0.9),
            0 0 12px rgba(22, 163, 74, 0.9);
        }
      }

      .badge {
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.6);
        padding: 0.3rem 0.7rem;
        font-size: 0.72rem;
        text-transform: uppercase;
        letter-spacing: 0.15em;
        color: var(--muted);
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        background-color: rgba(15, 23, 42, 0.85);
        backdrop-filter: blur(16px);
      }

      .badge-dot {
        width: 7px;
        height: 7px;
        border-radius: 999px;
        background: var(--accent);
        box-shadow: 0 0 0 4px var(--accent-soft);
      }

      .top-right-controls {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 0.45rem;
      }

      .music-toggle {
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.7);
        background: rgba(15, 23, 42, 0.85);
        color: var(--muted);
        padding: 0.25rem 0.8rem;
        font-size: 0.75rem;
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        cursor: pointer;
        backdrop-filter: blur(16px);
      }

      .music-toggle span.icon {
        font-size: 0.95rem;
      }

      .music-toggle.active {
        border-color: rgba(94, 234, 212, 0.95);
        color: #a5f3fc;
        background: radial-gradient(
          circle at top left,
          rgba(8, 47, 73, 0.94),
          rgba(15, 23, 42, 0.98)
        );
      }

      label {
        font-size: 0.82rem;
        font-weight: 500;
        margin-top: 0.8rem;
        display: block;
        color: #cbd5f5;
      }

      input,
      select,
      button {
        margin-top: 0.35rem;
        padding: 0.55rem 0.8rem;
        width: 100%;
        font-size: 0.9rem;
        border-radius: 0.7rem;
        border: 1px solid rgba(51, 65, 85, 0.9);
        background: radial-gradient(
            circle at top left,
            rgba(15, 23, 42, 0.9),
            rgba(15, 23, 42, 0.97)
          );
        color: var(--text);
        outline: none;
        transition: border 0.15s, box-shadow 0.15s, background 0.15s,
          transform 0.05s;
      }

      input::placeholder {
        color: var(--muted);
      }

      input:focus,
      select:focus {
        border-color: rgba(94, 234, 212, 0.9);
        box-shadow: 0 0 0 1px rgba(94, 234, 212, 0.6);
      }

      button {
        cursor: pointer;
        background: linear-gradient(145deg, #22c55e, #4ade80);
        border: none;
        font-weight: 600;
        color: #022c22;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        padding-inline: 1rem;
        box-shadow:
          0 14px 35px rgba(22, 163, 74, 0.7),
          0 0 0 1px rgba(21, 128, 61, 0.6);
      }

      button:hover {
        transform: translateY(-1px);
        box-shadow:
          0 18px 45px rgba(22, 163, 74, 0.85),
          0 0 0 1px rgba(21, 128, 61, 0.6);
      }

      button:active {
        transform: translateY(1px);
        box-shadow:
          0 9px 20px rgba(22, 163, 74, 0.7),
          0 0 0 1px rgba(21, 128, 61, 0.6);
      }

      #log {
        white-space: pre-wrap;
        background: var(--glass);
        padding: 0.95rem;
        margin-top: 1.1rem;
        border-radius: 0.95rem;
        border: 1px solid rgba(51, 65, 85, 0.95);
        max-height: 260px;
        overflow-y: auto;
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          'Liberation Mono', 'Courier New', monospace;
        font-size: 0.78rem;
        color: #bbf7d0;
        box-shadow: inset 0 0 40px rgba(15, 23, 42, 0.9);
      }

      .row {
        display: flex;
        gap: 0.6rem;
        margin-top: 1.15rem;
      }

      .row button {
        width: 100%;
      }

      small {
        color: var(--muted);
        display: block;
        margin-top: 0.3rem;
        font-size: 0.72rem;
      }

      .pk-masked {
        letter-spacing: 0.14em;
      }

      @media (max-width: 640px) {
        .shell {
          padding: 1.4rem 1.15rem 1.2rem;
          border-radius: 1.3rem;
          transform: none;
        }

        .shell:hover {
          transform: none;
        }

        h1 {
          font-size: 1.2rem;
        }

        .header-row {
          flex-direction: column;
          align-items: flex-start;
        }

        .top-right-controls {
          width: 100%;
          align-items: flex-start;
        }
      }
    </style>
  </head>
  <body>
    <div class="shell">
      <div class="content">
        <div class="header-row">
          <div class="title-block">
            <h1>PT.BRONZE-402</h1>
            <div class="subtitle">Powered by CUPANG VENTURE</div>
          </div>
          <div class="top-right-controls">
            <div class="badge">
              <span class="badge-dot"></span>
              LIVE SESSION
            </div>
            <button
              type="button"
              class="music-toggle"
              id="musicToggle"
              title="Toggle background music"
            >
              <span class="icon">?</span>
              <span>Music: ON</span>
            </button>
          </div>
        </div>

        <label>Private Key (user):</label>
        <input type="text" id="privateKey" placeholder="0x..." />

        <label>Bearer Token :</label>
        <input type="text" id="bearer" placeholder="Bearer token" />

        <label>RPC Provider:</label>
        <select id="rpcSelect">
          <option value="https://bsc.blockrazor.xyz" selected>
            Blockrazor RPC
          </option>
          <option value="https://bsc-dataseed.binance.org">Binance Seed</option>
          <option value="https://bsc-rpc.publicnode.com">Public Node</option>
          <option value="custom">Custom RPC (manual)</option>
        </select>

        <input
          type="text"
          id="rpcCustom"
          placeholder="https://your-custom-rpc.com"
          style="display: none"
        />

        <label>Jumlah mint :</label>
        <input type="number" id="count" value="2" min="2" max="5" />

        <small>
          Private key & bearer diisi masing-masing user di sini.<br />
        </small>

        <div class="row">
          <button id="sendBtn">Confirm</button>
        </div>

        <h2
          style="
            font-size: 0.9rem;
            margin-top: 1.25rem;
            margin-bottom: 0.4rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: #9ca3af;
          "
        >
          Session Log
        </h2>
        <div id="log"></div>
      </div>
    </div>

    <!-- Music iframe (auto-play on load), bisa dimatikan lewat tombol -->
    <div id="musicContainer" style="display:none;"></div>

    <script>
      const rpcSelect = document.getElementById('rpcSelect')
      const rpcCustom = document.getElementById('rpcCustom')
      const logEl = document.getElementById('log')
      const sendBtn = document.getElementById('sendBtn')
      const privateKeyInput = document.getElementById('privateKey')
      const musicToggle = document.getElementById('musicToggle')
      const musicContainer = document.getElementById('musicContainer')

      // === PLAYLIST YOUTUBE (EDIT DI SINI SAJA UNTUK TAMBAH LAGU) ===
      // Tinggal tambahkan video ID baru ke array ini.
      // Contoh URL: https://www.youtube.com/watch?v=Cztli8ZOF70
      // Video ID = Cztli8ZOF70
      const videoIds = [
        'Cztli8ZOF70', // lagu 1
        'RD0tsiYTga41o', // lagu 2
        // 'VIDEO_ID3',
        // 'VIDEO_ID4',
      ]

      // === Show/hide custom RPC field ===
      rpcSelect.addEventListener('change', () => {
        rpcCustom.style.display =
          rpcSelect.value === 'custom' ? 'block' : 'none'
      })

      // === Masking Private Key dengan ****** ===
      let realPrivateKey = ''

      privateKeyInput.addEventListener('input', (e) => {
        const value = e.target.value.trim()
        realPrivateKey = value

        if (value.length > 0) {
          const visible = value.slice(0, 4)
          const maskedLength = Math.max(value.length - 4, 6)
          const masked = '*'.repeat(maskedLength)
          privateKeyInput.value = visible + masked
          privateKeyInput.classList.add('pk-masked')
        } else {
          privateKeyInput.classList.remove('pk-masked')
        }
      })

      // === Logging ===
      function log(message) {
        logEl.textContent += message + '\n'
        logEl.scrollTop = logEl.scrollHeight
      }

      // === MUSIC: playlist YouTube by videoIds ===
      let musicActive = false

      function startMusic() {
        if (musicActive) return
        if (!videoIds.length) {
          log('?? Playlist kosong, tidak ada music yang diputar.')
          return
        }

        const iframe = document.createElement('iframe')
        iframe.width = '0'
        iframe.height = '0'
        iframe.style.display = 'none'

        // video pertama sebagai main, semua videoIds jadi playlist
        const firstId = videoIds[0]
        const playlistParam = videoIds.join(',')

        iframe.src =
          'https://www.youtube.com/embed/' +
          firstId +
          '?autoplay=1&loop=1&playlist=' +
          playlistParam

        iframe.setAttribute(
          'allow',
          'autoplay; encrypted-media; fullscreen; picture-in-picture'
        )
        iframe.setAttribute('frameborder', '0')

        musicContainer.innerHTML = ''
        musicContainer.appendChild(iframe)
        musicContainer.style.display = 'block'

        musicActive = true
        musicToggle.classList.add('active')
        musicToggle.querySelector('.icon').textContent = '?'
        musicToggle.querySelector('span:last-child').textContent = 'Music: ON'
        log('?? Background music playlist started.')
      }

      function stopMusic() {
        musicContainer.innerHTML = ''
        musicContainer.style.display = 'none'
        musicActive = false
        musicToggle.classList.remove('active')
        musicToggle.querySelector('.icon').textContent = '?'
        musicToggle.querySelector('span:last-child').textContent = 'Music: OFF'
        log('? Music stopped.')
      }

      // Auto-start music on load (bisa saja diblokir browser, tergantung policy)
      window.addEventListener('load', () => {
        startMusic()
      })

      // Toggle button
      musicToggle.addEventListener('click', () => {
        if (musicActive) {
          stopMusic()
        } else {
          startMusic()
        }
      })

      // === Send request (Confirm) ===
      sendBtn.addEventListener('click', async () => {
        const bearer = document.getElementById('bearer').value.trim()
        let count = parseInt(document.getElementById('count').value) || 2
        const rpcUrl =
          rpcSelect.value === 'custom'
            ? rpcCustom.value.trim()
            : rpcSelect.value

        if (count < 2) count = 2
        if (count > 5) count = 5

        if (!realPrivateKey) {
          alert('Private Key wajib diisi!')
          return
        }
        if (rpcSelect.value === 'custom' && !rpcUrl) {
          alert('Isi URL RPC custom terlebih dahulu!')
          return
        }

        log('?? Confirm pressed.')
        log(`RPC: ${rpcUrl}`)
        log(`Mint count (x0.1 USDT): ${count}`)
        log('--------------------------')

        try {
          const res = await fetch('/api/send', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              privateKey: realPrivateKey,
              count,
              rpcUrl,
              bearer, // kalau backend mau pakai/log
            }),
          })

          const data = await res.json()

          if (data.ok) {
            log(`? Backend OK.`)
            log(`Address: ${data.address}`)
            log(`Loops: ${data.loops}`)
            if (data.approveTxHash) {
              log(`Approve Tx: ${data.approveTxHash}`)
            }
            if (Array.isArray(data.results)) {
              data.results.forEach((r, idx) => {
                const no = idx + 1
                if (r.success) {
                  const tx =
                    r.txHash ||
                    r.hash ||
                    r.transactionHash ||
                    '[txHash tidak terdeteksi]'
                  log(`Mint #${no}: ? success | tx=${tx}`)
                } else {
                  log(
                    `Mint #${no}: ? failed | error=${
                      r.error || 'unknown error'
                    }`
                  )
                }
              })
            }
          } else {
            log('? Error: ' + (data.error || JSON.stringify(data)))
          }
        } catch (err) {
          log('? Exception: ' + err.message)
        }
      })
    </script>
  </body>
</html>
